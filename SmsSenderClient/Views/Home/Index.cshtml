@model MessageViewModel
@{
    ViewData["Title"] = "Message Page";
}

<div class="mx-auto w-full max-w-md px-4 py-6">
    <h1 class="text-2xl font-semibold tracking-tight mb-4 text-center">Send us a message</h1>

    <form asp-controller="Message"
          asp-action="SendMessage"
          method="post"
          class="space-y-4 bg-white/70 backdrop-blur rounded-xl p-4 shadow-sm"
          novalidate>
        @Html.AntiForgeryToken()

        <div asp-validation-summary="ModelOnly" class="text-red-600 text-sm"></div>

        <div class="flex flex-col">
            <label asp-for="Name" class="mb-1 text-sm font-medium">Your name (optional)</label>
            <input asp-for="Name"
                   type="text"
                   autocomplete="name"
                   class="w-full rounded-lg border border-slate-300 px-3 py-2 text-base focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"
                   placeholder="Jane Doe" />
            <span asp-validation-for="Name" class="text-red-600 text-xs mt-1"></span>
        </div>

        <div class="flex flex-col">
            <label asp-for="Message" class="mb-1 text-sm font-medium">Message</label>
            <textarea asp-for="Message"
                      rows="6"
                      maxlength="500"
                      class="w-full resize-y rounded-lg border border-slate-300 px-3 py-2 text-base leading-relaxed focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"
                      placeholder="Type your message…"></textarea>
            <div class="flex items-center justify-between mt-1">
                <span asp-validation-for="Message" class="text-red-600 text-xs"></span>
                <span id="msgCounter" class="text-xs text-slate-500">0 / 500</span>
            </div>
        </div>

        <button type="submit"
                class="w-full rounded-lg bg-sky-600 px-4 py-2.5 text-white font-medium active:scale-[0.99] hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-sky-500">
            Send
        </button>

        <!-- Примечание для мобильных -->
        <p class="text-[11px] text-slate-500 text-center">
            Max 500 symbols. Your data is not stored longer than needed.
        </p>
    </form>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <script>
        (function () {
            const ta = document.querySelector('textarea[name="Message"]');
            const counter = document.getElementById('msgCounter');
            if (!ta || !counter) return;

            const update = () => {
                const len = ta.value.length || 0;
                counter.textContent = `${len} / 500`;
            };

            ta.addEventListener('input', update, { passive: true });
            update();
        })();
    </script>
}
